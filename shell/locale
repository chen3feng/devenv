# Set the best locale
function fix_locale() {
    local all
    local all=$(locale -a 2>/dev/null)
    # https://superuser.com/questions/999133/differences-between-en-us-utf8-and-en-us-utf-8
    local prefered_locales="zh_CN.UTF-8 zh_CN.utf8 en_US.UTF-8 en_US.utf8 C.UTF-8 C"
    local l
    for l in $prefered_locales; do
        if [[ "$all" == *"$l"* ]]; then
            export LC_ALL="$l"
            return
        fi
    done
    echo "Warning: Can't set correct locale" > /dev/stderr
}

fix_locale
